振り返り

miro
https://miro.com/app/board/uXjVJsUwpiY=/

仕様書
https://jira.next-group.jp/wiki/pages/viewpage.action?pageId=482593158

Keep

- リリース日までに間に合ってよかった
- 仕様書をデザイン側と開発側に分けて作ってもらったので、読みやすかった
- 中島さんとのペアプロは初めてだったが、作業分担がうまくいったのか、スムーズに実装できた
- 技術的な話では、Tailwind の設定が大きく進み、今後の開発スピードの短縮につながった
- 同じ時期に他の施策で開発する画面と共通する部分をティハさんが先にコーディングを進めて共有してくれたので、効率的に実装できた
- モックの段階で AB テストや Tealium の実装が進められて、企画側にも確認を依頼でき、コーディング完了の前に機能の実装を Fix できた
- Figma デザインファイルに ​icon の ​ パスを ​ つけてくれたので ​ 分かりやすかった ​

Problem

- 11/13 のリリース後に不具合が発生し、バグの対応に追われた
  【経緯について】
- 11/13（木） リリース後に「アローアイコンの表示エラー」と「LP ページの CTA ボタンで予約フォームへ abtest 用のパラメータが渡っていなかった」という不具合が確認された
- 11/14（金） 上記のバグ対応をリリース
  -> アイコン、LP ページ共に解消
- その後、A パターンの際に Amplitude で AB テストの判定が正常にできていない事象が確認されたため、即日対応
  -> TOP ページへの abtest_type 実装を確認
  11/17（月） AB テストの配信比率が設定と異なると連絡を受けて調査、abtest_type のデータ型が文字列の実装をしていたため、配列型の文字列に合わず Amplitude へ送られていない不具合が確認された
  -> 即日対応、TOP ページへの abtest_type が取得できたことを確認（配信比率も改善）

- ペアプロによって作業を分担できた反面、今までのコーディング上の知見のようなものが伝えきれていなくて、バグに繋がってしまった。コードレビューでも見逃していた。
- Tailwind の設定をするために工数が追加でかかった（後半のバタバタにつながった気がする）
- デザインの ​ Fix が ​ 実装の ​ 開始後だった ​ ため、​ 後半の ​ 確認作業が ​ 増えた ​ 気が ​ する ​
- デザイン確認で ​ 予定していた ​ 日の ​ 終わり際に ​ 依頼する ​ ことになってしまって ​ デザイナー側の ​ 負担を ​ させてしまった ​（後半の ​ バタバタの ​ 要因？）​
- Amplitude で ​ 値が ​ 取得できていないと ​ いう ​ 気づきが ​ テスト環境までの ​ 確認で ​ 出来ていなかった ​（tool では ​ 判断しにくかった）​
- （技術的な ​ 話）​ ソース内が、​BlueMonkey 時代の ​ アッセットと ​ それ以降に ​ 新しく ​ 作られた ​ ソースや ​ 画像などが ​ 入り乱れているので ​ 新しく ​ 関わる ​ 人には ​ 分かりにくい構造に ​ なってしまっている ​
- 開発環境では ​ 見えるが ​ 本番環境では ​ 見えないと ​ いう ​ 現象が ​ あった ​（矢印 icon の ​ 話）​

=====

Try

=====

起きた事象を時系列でまとめる

11/13（木） リリース後

- セミナーページ
  - アローアイコンの表示エラー
    - 内部のネットワークからだけ見れる形式のアイコンを利用していたためテストで検知できなかった
    - Netskope 使ってると見えるから判断つかない
- LP ページ
  - cta parts
    - Salesforce の reserveURL が add_abtest_query でラップされていない箇所があったので修正
    - 予約フォームへ abtest 用のパラメータが渡っていなかった

翌日の hotfix で対応

11/14（金）

- A パターン（TOP ページ）での abtest_type が未実装だったために、Amplitude で AB テストの判定が正常にできてなかった

合わせて hotfix にて即日対応
https://github.com/lifull/madoguchi-web/pull/840
-> アイコン、LP ページ共に解消
-> TOP ページへの abtest_type 実装を確認

11/17（月）

- AB テストの配信比率が設定と異なると連絡
  -> abtest_type のデータ型が文字列の実装をしていたため、配列型の文字列に合わず Amplitude へ送られていなかった

hotfix にて即日対応
https://github.com/lifull/madoguchi-web/pull/849
-> TOP ページへの abtest_type が取得できたことを確認

===

abtest_type について

・本番リリース後に、AB テストの配信比率が 50:50 になっていないことから発覚
・調査後に、下記の点が分かった
　・TOP ページ（A パターン）にて abtest_type が反映されていない
　・仕様書には abtest_type について記載がなく、実装時に TOP ページにも abtest_type が必要との認識がなかった
　・abtest_type の値が配列形文字列データという認識がなかった
・テスト環境での Amplitude 確認はしていた

今後について（案）
・仕様書への全ての Tealium 関連の値を明記
・企画者、開発側どちらもプロダクトリスクの確認
・AB テストの場合に何を実装するかの認識合わせ
・テスト環境での Amplitude での確認方法の見直し
